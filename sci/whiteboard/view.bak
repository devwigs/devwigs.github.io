<!DOCTYPE html>
<html lang="en-ca">
<head>
<meta charset="utf8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Whiteboard Monitor</title>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<link rel="shortcut icon" type="image/x-icon" href="../media/favicon.ico"/>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Oxygen:400,700"/>
<style>

p {text-align:center}
input {width:2em}

img {
    max-width:99%;
    height:auto;
    border:1px solid black;
    margin:0.25em;
}

nav span {cursor:pointer}

</style>
<script type="text/javascript">

function update() {
    $.ajax(update.url, {type:"POST", data:{access: update.access}, dataType:"text/plain", complete:function(a) {
        a = a.responseText;
        if (a) $("#Live").attr("src", a);
        update.timeout = setTimeout(update, 250);
    }});
}

update.url = "https://png-mirror.davidmaccarthy.repl.co";
update.access = localStorage.getItem("sync-access");

function rotate(x) {
    if (x == null) x = parseFloat(prompt("Angle?"));
    if (!isNaN(x)) $("#Live").css("transform", `rotate(${x}deg)`);
}

function copy() {
    let cv = $("#Live");
    let src = cv.attr("src");
    let img = $("<img>").attr({src:src}).click(deletePage);
    cv.closest("p").prepend(img);
    img.css("transform", cv.css("transform"))
}

function deletePage(ev) {
    if (ev.ctrlKey) $(this).remove();
}

$(update);

</script>
</head>
<body>
    <nav>
        <span onclick="rotate(0)">↑</span>
        <span onclick="rotate(90)">→</span>
        <span onclick="rotate(180)">↓</span>
        <span onclick="rotate(270)">←</span>
        <span onclick="rotate()">↻</span>
        <button onclick="copy()">Copy</button>
    </nav>
    <p><img id="Live" src=""/></p>
</body>
</html>
 